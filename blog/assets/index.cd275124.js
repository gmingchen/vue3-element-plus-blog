var te=Object.defineProperty,ae=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var N=(e,l,r)=>l in e?te(e,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[l]=r,h=(e,l)=>{for(var r in l||(l={}))ne.call(l,r)&&N(e,r,l[r]);if(U)for(var r of U(l))re.call(l,r)&&N(e,r,l[r]);return e},w=(e,l)=>ae(e,oe(l));import{g as S,y as F,u as se,h as I,X as B,B as q,Y as T,C as R,a4 as L,aI as ie,ai as de,aj as D,o as m,i as _,w as a,J as z,q as t,K as c,L as v,ae as C,am as K,k as A,H as Y,I as J,an as M,a1 as P,aF as ue,a3 as G,a2 as O,af as X,aE as me,a6 as pe,ak as fe,as as be,at as ge,al as ce,r as Q,j as ve,ah as ye}from"./vendor.9347675a.js";import{s as $,c as _e}from"./request.814c4204.js";/* empty css                        *//* empty css                   *//* empty css                        *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                   *//* empty css                        */import{_ as W}from"./el-radio.ee17be63.js";import{_ as Z,e as x,B as ee}from"./index.84770b9f.js";import{u as ke}from"./page.ce5ba239.js";function Ee(e){return $({url:"/console/banner/page",method:"get",params:e})}function Ce(e){return $({url:"/console/banner/info",method:"get",params:e})}function Ve(e){return $({url:"/console/banner/create",method:"post",data:e})}function $e(e){return $({url:"/console/banner/update",method:"post",data:e})}function he(e){return $({url:"/console/banner/delete",method:"post",data:e})}const we=S({components:{Upload:W},emits:["refresh"],setup(e,{emit:l}){const{t:r}=F(),y=se(),f=I(()=>y.getters["setting/language"]),b=B(),n=q({visible:!1,loading:!1,STATUS:x,BANNER_TYPE:ee,watermark:!1,form:{id:null,title:"",image:"",url:"",type:0,sort:0,status:1}}),p=I(()=>{const s={title:[{required:!0,message:r("rule.notBlank",[r("table.headline")]),trigger:"blur"}],image:[{required:!0,message:r("rule.notBlank",[r("table.image")]),trigger:"change"}]};return T(()=>{b.value.clearValidate()}),s}),g=async s=>{if(n.visible=!0,n.loading=!0,n.form.id=s,n.form.id){const i=await Ce({id:n.form.id});i&&(n.form.title=i.data.title,n.form.image=i.data.image,n.form.url=i.data.url,n.form.type=i.data.type,n.form.sort=i.data.sort,n.form.status=i.data.status)}T(()=>{n.loading=!1})},k=()=>{b.value.validate(async s=>{s&&(n.form.id?await $e(n.form):await Ve(n.form))&&(n.visible=!1,L({message:r("tip.success"),type:"success"}),l("refresh"))})},d=()=>{b.value.resetFields()};return w(h({t:r,language:f,refForm:b},R(n)),{rules:p,init:g,submit:k,dialogClosedHandle:d})}}),Te={class:"dialog-footer"};function He(e,l,r,y,f,b){const n=M,p=P,g=W,k=me,d=ue,s=ie,i=G,E=O,H=de,j=X,V=D("repeat");return m(),_(H,{modelValue:e.visible,"onUpdate:modelValue":l[9]||(l[9]=o=>e.visible=o),width:"500px",title:e.t(`button.${e.form.id?"edit":"add"}`),"close-on-click-modal":!1,onClosed:e.dialogClosedHandle},{footer:a(()=>[z("span",Te,[t(E,{onClick:l[7]||(l[7]=o=>e.visible=!1)},{default:a(()=>[c(v(e.t("button.cancel")),1)]),_:1}),C((m(),_(E,{type:"primary",onClick:l[8]||(l[8]=o=>e.submit())},{default:a(()=>[c(v(e.t("button.confirm")),1)]),_:1})),[[V]])])]),default:a(()=>[C((m(),_(i,{ref:"refForm",model:e.form,rules:e.rules,"label-position":"top",onKeyup:l[6]||(l[6]=K(o=>e.submit(),["enter"]))},{default:a(()=>[t(p,{label:e.t("table.headline"),prop:"title"},{default:a(()=>[t(n,{modelValue:e.form.title,"onUpdate:modelValue":l[0]||(l[0]=o=>e.form.title=o),placeholder:e.t("table.headline"),maxlength:"20","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(p,{label:e.t("table.image"),prop:"image"},{default:a(()=>[z("div",null,[t(g,{url:e.form.image,"onUpdate:url":l[1]||(l[1]=o=>e.form.image=o),watermark:e.watermark},null,8,["url","watermark"])])]),_:1},8,["label"]),t(p,{label:e.t("table.type"),prop:"type"},{default:a(()=>[t(d,{modelValue:e.form.type,"onUpdate:modelValue":l[2]||(l[2]=o=>e.form.type=o)},{default:a(()=>[(m(!0),A(J,null,Y(e.BANNER_TYPE,o=>(m(),_(k,{key:o.value,label:o.value},{default:a(()=>[c(v(o[`label_${e.language}`]),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e.t("column.link"),prop:"url"},{default:a(()=>[t(n,{modelValue:e.form.url,"onUpdate:modelValue":l[3]||(l[3]=o=>e.form.url=o),placeholder:e.t("column.link"),maxlength:"100"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(p,{label:e.t("table.sort"),prop:"sort"},{default:a(()=>[t(s,{modelValue:e.form.sort,"onUpdate:modelValue":l[4]||(l[4]=o=>e.form.sort=o),min:0},null,8,["modelValue"])]),_:1},8,["label"]),t(p,{label:e.t("table.status"),prop:"status"},{default:a(()=>[t(d,{modelValue:e.form.status,"onUpdate:modelValue":l[5]||(l[5]=o=>e.form.status=o)},{default:a(()=>[(m(!0),A(J,null,Y(e.STATUS,o=>(m(),_(k,{key:o.value,label:o.value},{default:a(()=>[c(v(o[`label_${e.language}`]),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[j,e.loading]])]),_:1},8,["modelValue","title","onClosed"])}var je=Z(we,[["render",He]]);const Be=S({components:{AddEdit:je},setup(){const{t:e}=F(),l=B(),r=B(),{page:y}=ke(),f=q({loading:!1,visible:!1,STATUS:x,BANNER_TYPE:ee,form:{name:""},list:[],selection:[]}),b=()=>{const s=w(h({},f.form),{current:y.current,size:y.size});f.loading=!0,Ee(s).then(i=>{i&&(f.list=i.data.list,y.total=i.data.total),T(()=>{f.loading=!1})})},n=()=>{y.current=1,b()},p=s=>{f.visible=!0,T(()=>{r.value.init(s)})},g=s=>{let i;s?i=[s]:i=f.selection.map(E=>E.id),ye.confirm(e("tip.confirmOperationTip",[i.join(","),s?e("button.delete"):e("button.batch",[e("button.delete")])]),e("tip.title"),{confirmButtonText:e("button.confirm"),cancelButtonText:e("button.cancel"),type:"warning"}).then(()=>{he(i).then(E=>{E&&(L({message:e("tip.success"),type:"success"}),b())})}).catch(()=>{})},k=s=>{f.selection=s},d=s=>{y.current=s.current,y.size=s.size,b()};return pe(()=>{b()}),w(h({t:e,refForm:l,refAddEdit:r,page:y},R(f)),{getList:b,reacquireHandle:n,addEditHandle:p,delHandle:g,selectionHandle:k,pageChangeHandle:d,clearJson:_e})}});function Ae(e,l,r,y,f,b){const n=M,p=P,g=O,k=G,d=fe,s=be,i=ge,E=ce,H=Q("g-page"),j=Q("add-edit"),V=D("repeat"),o=X;return m(),A("div",null,[t(k,{ref:"refForm",inline:!0,onKeyup:l[5]||(l[5]=K(u=>e.reacquireHandle(),["enter"]))},{default:a(()=>[t(p,null,{default:a(()=>[t(n,{modelValue:e.form.name,"onUpdate:modelValue":l[0]||(l[0]=u=>e.form.name=u),placeholder:e.t("column.name"),clearable:""},null,8,["modelValue","placeholder"])]),_:1}),t(p,null,{default:a(()=>[C((m(),_(g,{onClick:l[1]||(l[1]=u=>e.reacquireHandle())},{default:a(()=>[c(v(e.t("button.search")),1)]),_:1})),[[V]]),C((m(),_(g,{onClick:l[2]||(l[2]=u=>(e.clearJson(e.form),e.reacquireHandle()))},{default:a(()=>[c(v(e.t("button.reset")),1)]),_:1})),[[V]]),C((m(),_(g,{type:"primary",onClick:l[3]||(l[3]=u=>e.addEditHandle())},{default:a(()=>[c(v(e.t("button.add")),1)]),_:1})),[[V]]),C((m(),_(g,{type:"danger",disabled:e.selection.length<=0,onClick:l[4]||(l[4]=u=>e.delHandle())},{default:a(()=>[c(v(e.t("button.batch",[e.t("button.delete")])),1)]),_:1},8,["disabled"])),[[V]])]),_:1})]),_:1},512),C((m(),_(E,{border:"",data:e.list,onSelectionChange:e.selectionHandle},{default:a(()=>[t(d,{align:"center",type:"selection",width:"50"}),t(d,{align:"center",label:"ID",prop:"id",width:"80"}),t(d,{align:"center",label:e.t("table.headline"),prop:"title"},null,8,["label"]),t(d,{align:"center",label:e.t("table.image"),prop:"image"},{default:a(({row:u})=>[t(s,{class:"img",src:u.image,"preview-src-list":[u.image]},null,8,["src","preview-src-list"])]),_:1},8,["label"]),t(d,{align:"center",label:e.t("column.link"),prop:"url"},null,8,["label"]),t(d,{align:"center",label:e.t("table.type"),prop:"type",width:"100"},{default:a(({row:u})=>[c(v(e.BANNER_TYPE.getLabel(u.type)),1)]),_:1},8,["label"]),t(d,{align:"center",label:e.t("table.sort"),prop:"sort"},null,8,["label"]),t(d,{align:"center",label:e.t("table.status"),prop:"status",width:"100"},{default:a(({row:u})=>[t(i,{type:u.status===1?"success":"danger"},{default:a(()=>[c(v(e.STATUS.getLabel(u.status)),1)]),_:2},1032,["type"])]),_:1},8,["label"]),t(d,{align:"center",label:e.t("table.createTime"),prop:"created_at",width:"160"},null,8,["label"]),t(d,{align:"center",label:e.t("table.updateTime"),prop:"updated_at",width:"160"},null,8,["label"]),t(d,{align:"center",label:e.t("table.operation"),width:"110",fixed:"right"},{default:a(({row:u})=>[t(g,{type:"text",onClick:le=>e.addEditHandle(u.id)},{default:a(()=>[c(v(e.t("button.edit")),1)]),_:2},1032,["onClick"]),t(g,{type:"text",onClick:le=>e.delHandle(u.id)},{default:a(()=>[c(v(e.t("button.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange"])),[[o,e.loading]]),t(H,{page:e.page,onChange:e.pageChangeHandle},null,8,["page","onChange"]),e.visible?(m(),_(j,{key:0,ref:"refAddEdit",onRefresh:e.getList},null,8,["onRefresh"])):ve("",!0)])}var Pe=Z(Be,[["render",Ae],["__scopeId","data-v-c9cbb8b8"]]);export{Pe as default};
