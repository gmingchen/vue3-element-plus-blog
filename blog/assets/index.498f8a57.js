var O=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var w=(e,t,o)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,H=(e,t)=>{for(var o in t||(t={}))G.call(t,o)&&w(e,o,t[o]);if(V)for(var o of V(t))P.call(t,o)&&w(e,o,t[o]);return e},_=(e,t)=>X(e,Y(t));import{g as B,y as T,X as j,B as A,h as Q,Y as h,C as q,a4 as F,ai as W,aj as D,o as f,i as g,w as a,J as Z,q as i,K as C,L as $,ae as k,am as z,an as I,a1 as K,a3 as L,a2 as N,af as J,a6 as x,ak as ee,al as te,r as M,k as ne,j as oe,ah as ae}from"./vendor.9347675a.js";import{c as le}from"./request.814c4204.js";/* empty css                        *//* empty css                   *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                   */import{i as ie,a as se,e as re,p as de,d as me}from"./index.07f57bee.js";import{_ as R}from"./index.84770b9f.js";import{u as ue}from"./page.ce5ba239.js";const pe=B({emits:["refresh"],setup(e,{emit:t}){const{t:o}=T(),s=j(),n=A({visible:!1,loading:!1,form:{id:null,name:""}}),c=Q(()=>{const m={name:[{required:!0,message:o("rule.notBlank",[o("column.name")]),trigger:"blur"}]};return h(()=>{s.value.clearValidate()}),m}),y=async m=>{if(n.visible=!0,n.loading=!0,n.form.id=m,n.form.id){const r=await ie({id:n.form.id});r&&(n.form.name=r.data.name)}h(()=>{n.loading=!1})},v=()=>{s.value.validate(async m=>{m&&(n.form.id?await re(n.form):await se(n.form))&&(n.visible=!1,F({message:o("tip.success"),type:"success"}),t("refresh"))})},d=()=>{s.value.resetFields()};return _(H({t:o,refForm:s},q(n)),{rules:c,init:y,submit:v,dialogClosedHandle:d})}}),fe={class:"dialog-footer"};function ce(e,t,o,s,n,c){const y=I,v=K,d=L,m=N,r=W,l=J,u=D("repeat");return f(),g(r,{modelValue:e.visible,"onUpdate:modelValue":t[4]||(t[4]=p=>e.visible=p),width:"500px",title:e.t(`button.${e.form.id?"edit":"add"}`),"close-on-click-modal":!1,onClosed:e.dialogClosedHandle},{footer:a(()=>[Z("span",fe,[i(m,{onClick:t[2]||(t[2]=p=>e.visible=!1)},{default:a(()=>[C($(e.t("button.cancel")),1)]),_:1}),k((f(),g(m,{type:"primary",onClick:t[3]||(t[3]=p=>e.submit())},{default:a(()=>[C($(e.t("button.confirm")),1)]),_:1})),[[u]])])]),default:a(()=>[k((f(),g(d,{ref:"refForm",model:e.form,rules:e.rules,"label-position":"top",onKeyup:t[1]||(t[1]=z(p=>e.submit(),["enter"]))},{default:a(()=>[i(v,{label:e.t("column.name"),prop:"name"},{default:a(()=>[i(y,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=p=>e.form.name=p),placeholder:e.t("column.name"),maxlength:"20","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[l,e.loading]])]),_:1},8,["modelValue","title","onClosed"])}var be=R(pe,[["render",ce]]);const ge=B({components:{AddEdit:be},setup(){const{t:e}=T(),t=j(),o=j(),{page:s}=ue(),n=A({loading:!1,visible:!1,form:{name:""},list:[],selection:[]}),c=()=>{const l=_(H({},n.form),{current:s.current,size:s.size});n.loading=!0,de(l).then(u=>{u&&(n.list=u.data.list,s.total=u.data.total),h(()=>{n.loading=!1})})},y=()=>{s.current=1,c()},v=l=>{n.visible=!0,h(()=>{o.value.init(l)})},d=l=>{let u;l?u=[l]:u=n.selection.map(p=>p.id),ae.confirm(e("tip.confirmOperationTip",[u.join(","),l?e("button.delete"):e("button.batch",[e("button.delete")])]),e("tip.title"),{confirmButtonText:e("button.confirm"),cancelButtonText:e("button.cancel"),type:"warning"}).then(()=>{me(u).then(p=>{p&&(F({message:e("tip.success"),type:"success"}),c())})}).catch(()=>{})},m=l=>{n.selection=l},r=l=>{s.current=l.current,s.size=l.size,c()};return x(()=>{c()}),_(H({t:e,refForm:t,refAddEdit:o,page:s},q(n)),{getList:c,reacquireHandle:y,addEditHandle:v,delHandle:d,selectionHandle:m,pageChangeHandle:r,clearJson:le})}});function ve(e,t,o,s,n,c){const y=I,v=K,d=N,m=L,r=ee,l=te,u=M("g-page"),p=M("add-edit"),E=D("repeat"),S=J;return f(),ne("div",null,[i(m,{ref:"refForm",inline:!0,onKeyup:t[5]||(t[5]=z(b=>e.reacquireHandle(),["enter"]))},{default:a(()=>[i(v,null,{default:a(()=>[i(y,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=b=>e.form.name=b),placeholder:e.t("column.name"),clearable:""},null,8,["modelValue","placeholder"])]),_:1}),i(v,null,{default:a(()=>[k((f(),g(d,{onClick:t[1]||(t[1]=b=>e.reacquireHandle())},{default:a(()=>[C($(e.t("button.search")),1)]),_:1})),[[E]]),k((f(),g(d,{onClick:t[2]||(t[2]=b=>(e.clearJson(e.form),e.reacquireHandle()))},{default:a(()=>[C($(e.t("button.reset")),1)]),_:1})),[[E]]),k((f(),g(d,{type:"primary",onClick:t[3]||(t[3]=b=>e.addEditHandle())},{default:a(()=>[C($(e.t("button.add")),1)]),_:1})),[[E]]),k((f(),g(d,{type:"danger",disabled:e.selection.length<=0,onClick:t[4]||(t[4]=b=>e.delHandle())},{default:a(()=>[C($(e.t("button.batch",[e.t("button.delete")])),1)]),_:1},8,["disabled"])),[[E]])]),_:1})]),_:1},512),k((f(),g(l,{border:"",data:e.list,onSelectionChange:e.selectionHandle},{default:a(()=>[i(r,{align:"center",type:"selection",width:"50"}),i(r,{align:"center",label:"ID",prop:"id",width:"80"}),i(r,{align:"center",label:e.t("column.name"),prop:"name"},null,8,["label"]),i(r,{align:"center",label:e.t("table.createTime"),prop:"created_at"},null,8,["label"]),i(r,{align:"center",label:e.t("table.updateTime"),prop:"updated_at"},null,8,["label"]),i(r,{align:"center",label:e.t("table.operation"),width:"110",fixed:"right"},{default:a(({row:b})=>[i(d,{type:"text",onClick:U=>e.addEditHandle(b.id)},{default:a(()=>[C($(e.t("button.edit")),1)]),_:2},1032,["onClick"]),i(d,{type:"text",onClick:U=>e.delHandle(b.id)},{default:a(()=>[C($(e.t("button.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange"])),[[S,e.loading]]),i(u,{page:e.page,onChange:e.pageChangeHandle},null,8,["page","onChange"]),e.visible?(f(),g(p,{key:0,ref:"refAddEdit",onRefresh:e.getList},null,8,["onRefresh"])):oe("",!0)])}var Te=R(ge,[["render",ve]]);export{Te as default};
